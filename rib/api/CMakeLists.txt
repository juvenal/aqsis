PROJECT(RIBAPI)

SET(XSLTPROC xsltproc)

SET(APIXML ${CMAKE_CURRENT_SOURCE_DIR}/api.xml)

ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/ri.inl
	COMMAND ${XSLTPROC} -o ${CMAKE_CURRENT_BINARY_DIR}/ri.inl ${CMAKE_CURRENT_SOURCE_DIR}/apiheader.xsl ${APIXML}
	)
ADD_CUSTOM_TARGET(apiheader ALL echo
	DEPENDS  ${CMAKE_CURRENT_BINARY_DIR}/ri.inl
	)

ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/ri_cache.inl
	COMMAND ${XSLTPROC} -o ${CMAKE_CURRENT_BINARY_DIR}/ri_cache.inl ${CMAKE_CURRENT_SOURCE_DIR}/apicache.xsl ${APIXML}
	)
ADD_CUSTOM_TARGET(apicache ALL echo
	DEPENDS  ${CMAKE_CURRENT_BINARY_DIR}/ri_cache.inl
	)

ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/ri_validate.inl
	COMMAND ${XSLTPROC} -o ${CMAKE_CURRENT_BINARY_DIR}/ri_validate.inl ${CMAKE_CURRENT_SOURCE_DIR}/apivalidate.xsl ${APIXML}
	)
ADD_CUSTOM_TARGET(apivalidate ALL echo
	DEPENDS  ${CMAKE_CURRENT_BINARY_DIR}/ri_validate.inl
	)

ADD_CUSTOM_COMMAND(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/ri_debug.inl
	COMMAND ${XSLTPROC} -o ${CMAKE_CURRENT_BINARY_DIR}/ri_debug.inl ${CMAKE_CURRENT_SOURCE_DIR}/apidebug.xsl ${APIXML}
	)
ADD_CUSTOM_TARGET(apidebug ALL echo
	DEPENDS  ${CMAKE_CURRENT_BINARY_DIR}/ri_debug.inl
	)

INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/ri.inl ${PROJECT_SOURCE_DIR}/ri.h 
	DESTINATION ${INCLUDEDIR})
