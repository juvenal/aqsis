Import('env')
miqser_sources = Split("""
	miqser.cpp""")

miqserenv = env.Copy();
miqserenv.AppendUnique(CPPDEFINES = ['RIB_EXPORTS'])

miqserenv.AppendUnique(LIBS = ['argparse', 'ri2rib', 'aqsistypes', '$z_lib'])

# Set any platform specific options for this target
miqserenv.UseTargetOptions('miqser')

Import('rib2_objs rib2ri_sources')

# compile rib2ri here to catch miqserenv #defines
rib2ri_objs = miqserenv.StaticObject('rib2ri', rib2ri_sources)

miqser = miqserenv.Program('miqser', [miqser_sources, rib2ri_objs, rib2_objs])
miqserenv.Install('$BINDIR', miqser)

env.Distribute('rib/miqser', miqser_sources)
env.Distribute('rib/miqser', 'SConscript')

Return('miqser')
