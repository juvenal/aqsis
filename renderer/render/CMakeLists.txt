PROJECT(AQSISLIB)

INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR})
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/interfaces)
INCLUDE_DIRECTORIES(${BOOST_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${TIFF_INCLUDE_DIR})

# Internal dependencies
INCLUDE(${AQSISTYPES_SOURCE_DIR}/export.cmake)
INCLUDE(${RIBAPI_SOURCE_DIR}/export.cmake)
INCLUDE(${RIB2RI_SOURCE_DIR}/export.cmake)
INCLUDE(${RIB_SOURCE_DIR}/export.cmake)
INCLUDE(${SHADEREXECENV_SOURCE_DIR}/export.cmake)
INCLUDE(${SHADERVM_SOURCE_DIR}/export.cmake)

FILE(GLOB AQSISLIB_SRCS ${PROJECT_SOURCE_DIR}/*.cpp)
FILE(GLOB AQSISLIB_HDRS ${PROJECT_SOURCE_DIR}/*.h)

FILE(GLOB AQSISLIB_TEST_SRCS ${PROJECT_SOURCE_DIR}/*_test.cpp)

FILTER_OUT("${AQSISLIB_TEST_SRCS}" "${AQSISLIB_SRCS}" AQSISLIB_SRCS) 

INCLUDE(${RIB_SOURCE_DIR}/local.cmake)
INCLUDE(${RIB2RI_SOURCE_DIR}/local.cmake)
INCLUDE(${DDMANAGER_SOURCE_DIR}/local.cmake)
INCLUDE(${RAYTRACE_SOURCE_DIR}/local.cmake)

ADD_DEFINITIONS(-DRI_EXPORTS)

ADD_LIBRARY(aqsislib SHARED ${AQSISLIB_SRCS} ${RIB_SRCS} ${RIB2RI_SRCS} ${DDMANAGER_SRCS} ${RAYTRACE_SRCS})
ADD_DEPENDENCIES(aqsislib apiheader apicache apivalidate apidebug)
IF(WIN32)
	TARGET_LINK_LIBRARIES(aqsislib aqsistypes shadervm ${TIFF_LIBRARIES} ${ZLIB_LIBRARIES})
ENDIF(WIN32)

INSTALL(TARGETS aqsislib
	RUNTIME DESTINATION bin
	LIBRARY DESTINATION lib)

