PROJECT(D_XPM)

SET(D_XPM_CPP_SRCS aspXpm.cpp xpm.cpp)
FILE(GLOB D_XPM_C_SRCS ${PROJECT_SOURCE_DIR}/*.c)
FILE(GLOB D_XPM_HDRS ${PROJECT_SOURCE_DIR}/*.h)

SET(D_XPM_SRCS ${D_XPM_CPP_SRCS} ${D_XPM_C_SRCS})

ADD_DEFINITIONS(-DD_XPM_EXPORTS)

INCLUDE(${DDMANAGER_SOURCE_DIR}/export.cmake)
INCLUDE_DIRECTORIES(${AQSIS_TIFF_INCLUDE_DIR})

IF(AQSIS_TIFF_FOUND)
	ADD_LIBRARY(d_xpm SHARED ${D_XPM_SRCS} ${D_XPM_HDRS} ${INFORES_SRCS})
	# Generate the display declaration for the aqsisrc file.
	GET_TARGET_PROPERTY(LOCOFD_XPM d_xpm LOCATION)
	GET_FILENAME_COMPONENT(DISPLAYLIB ${LOCOFD_XPM} NAME)

	SET(LINKLIBS ${AQSIS_TIFF_LIBRARIES} ${AQSIS_ZLIB_LIBRARIES})

	TARGET_LINK_LIBRARIES(d_xpm ${LINKLIBS})

	INSTALL(TARGETS d_xpm 
		RUNTIME DESTINATION ${DISPLAYSDIR}
		LIBRARY DESTINATION ${DISPLAYSDIR}
		ARCHIVE DESTINATION ${LIBDIR})

	SOURCE_GROUP("Header Files" FILES ${D_XPM_HDRS})
ENDIF(AQSIS_TIFF_FOUND)
