PROJECT(PIQSL)

SET(PIQSLAPP_SRCS
	piqsl.cpp
	piqslbase.cpp
	image.cpp
	imagebuffer.cpp
	framebuffer.cpp
	book.cpp
	bookbrowser.cpp
	displayserverimage.cpp
	piqsl_ui.fl)

SET(PIQSLAPP_HDRS
	piqsl.h
	piqslbase.h
	image.h
	imagebuffer.h
	book.h
	framebuffer.h
	bookbrowser.h
	displayserverimage.h)

SET(PIQSLDISPLAY_SRCS
	piqsldisplay.cpp
	displayhelpers.c)

SET(PIQSLDISPLAY_HDRS
	piqsldisplay.h)

ADD_DEFINITIONS(-DPIQSL_EXPORTS)

INCLUDE(${AQSISTYPES_SOURCE_DIR}/export.cmake)
INCLUDE(${DDMANAGER_SOURCE_DIR}/export.cmake)
INCLUDE(${TINYXML_SOURCE_DIR}/export.cmake)
INCLUDE(${ARGPARSE_SOURCE_DIR}/export.cmake)

INCLUDE_DIRECTORIES(${TIFF_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${ZLIB_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${FLTK_INCLUDE_DIR})

ADD_LIBRARY(piqsldisplay SHARED ${PIQSLDISPLAY_SRCS})

SET(LINKLIBS)
INCLUDE(${AQSISTYPES_SOURCE_DIR}/link.cmake)

TARGET_LINK_LIBRARIES(piqsldisplay ${LINKLIBS})
SET_TARGET_PROPERTIES(piqsldisplay PROPERTIES VERSION ${MAJOR} SOVERSION "${MAJOR}.${MINOR}")

INSTALL(TARGETS piqsldisplay 
	RUNTIME DESTINATION ${DISPLAYSDIR}
	LIBRARY DESTINATION ${DISPLAYSDIR}
	ARCHIVE DESTINATION ${LIBDIR})

INCLUDE(${PROJECT_SOURCE_DIR}/export.cmake)

INCLUDE(${TINYXML_SOURCE_DIR}/local.cmake)
FLTK_WRAP_UI(PIQSL piqsl_ui.fl)

INCLUDE_DIRECTORIES(${BOOST_INCLUDE_DIR})

ADD_DEFINITIONS(-DPIQSL_APP_EXPORTS -DTIXML_USE_STL)

ADD_EXECUTABLE(piqsl ${PIQSLAPP_SRCS} ${PIQSL_FLTK_UI_SRCS} ${TINYXML_SRCS})

LINK_DIRECTORIES(${BOOST_LIB_DIR})
SET(LINKLIBS ${TIFF_LIBRARIES} ${ZLIB_LIBRARIES} ${FLTK_LIBRARIES} ${BOOST_THREAD_LIB})
INCLUDE(${AQSISTYPES_SOURCE_DIR}/link.cmake)
INCLUDE(${ARGPARSE_SOURCE_DIR}/link.cmake)

TARGET_LINK_LIBRARIES(piqsl ${LINKLIBS})
SET_TARGET_PROPERTIES(piqsl PROPERTIES INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/${RENDERENGINEDIR}")

INSTALL(TARGETS piqsl 
	RUNTIME DESTINATION ${BINDIR})
