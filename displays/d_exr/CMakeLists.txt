PROJECT(D_EXR)

FILE(GLOB D_EXR_CPP_SRCS ${PROJECT_SOURCE_DIR}/*.cpp)
FILE(GLOB D_EXR_C_SRCS ${PROJECT_SOURCE_DIR}/*.c)
FILE(GLOB D_EXR_HDRS ${PROJECT_SOURCE_DIR}/*.h)

SET(D_EXR_SRCS ${D_EXR_CPP_SRCS} ${D_EXR_C_SRCS})

ADD_DEFINITIONS(-DD_EXR_EXPORTS)

INCLUDE(${DDMANAGER_SOURCE_DIR}/export.cmake)
INCLUDE_DIRECTORIES(${AQSIS_OPENEXR_INCLUDE_DIR})

IF(AQSIS_OPENEXR_FOUND)
	ADD_LIBRARY(d_exr SHARED ${D_EXR_SRCS} ${D_EXR_HDRS})
	# Generate the display declaration for the aqsisrc file.
	GET_TARGET_PROPERTY(LOCOFD_EXR d_exr LOCATION)
	GET_FILENAME_COMPONENT(DISPLAYLIB ${LOCOFD_EXR} NAME)

	SET(LINKLIBS ${AQSIS_OPENEXR_LIBRARIES} ${AQSIS_ZLIB_LIBRARIES})

	TARGET_LINK_LIBRARIES(d_exr ${LINKLIBS})

	INSTALL(TARGETS d_exr 
		RUNTIME DESTINATION ${DISPLAYSDIR}
		LIBRARY DESTINATION ${DISPLAYSDIR}
		ARCHIVE DESTINATION ${LIBDIR})

	SOURCE_GROUP("Header Files" FILES ${D_EXR_HDRS})
ENDIF(AQSIS_OPENEXR_FOUND)
